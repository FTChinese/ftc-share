{"version":3,"file":null,"sources":["../src/js/share.js"],"sourcesContent":["const socialUrls = {\n\twechat: {\n\t\tname: \"微信\",\n\t\turl: \"http://www.ftchinese.com/m/corp/qrshare.html?title={{title}}&url={{url}}&ccode=2C1A1408\"\n\t},\n\tweibo: {\n\t\tname: \"微博\",\n\t\turl: \"http://service.weibo.com/share/share.php?&appkey=4221537403&url={{url}}&title=【{{title}}】{{summary}}&ralateUid=1698233740&source=FT中文网&sourceUrl=http://www.ftchinese.com/&content=utf8&ccode=2G139005\"\n\t},\n\tlinkedin: {\n\t\tname: \"领英\",\n\t\turl: \"http://www.linkedin.com/shareArticle?mini=true&url={{url}}&title={{title}}&summary={{summary}}&source=FT中文网\"\n\t},\n\tfacebook: {\n\t\tname: \"Facebook\",\n\t\turl: \"http://www.facebook.com/sharer.php?u={{url}}\"\n\t},\n\ttwitter: {\n\t\tname: \"Twitter\",\n\t\turl: \"https://twitter.com/intent/tweet?url={{url}}&amp;text=【{{title}}】{{summary}}&amp;via=FTChinese\"\n\t}\n};\n\nfunction getOgContent(metaEl) {\n\tif (!(metaEl instanceof HTMLElement)) {\n\t\tmetaEl = document.querySelector(metaEl);\n\t}\n\treturn metaEl.hasAttribute('content') ? metaEl.getAttribute('content') : '';\n}\n\n// Get page meta content statically. Should not put this inside the `Share` object in order to reduce DOM traverse.\nconst defaultConfig = {\n\tlinks: ['wechat', 'weibo', 'linkedin', 'facebook', 'twitter'],\n\n\turl: window.location.href || '',\n\tsummary: getOgContent('meta[property=\"og:description\"]'),\n\ttitle: getOgContent('meta[property=\"og:title\"]')\n};\n\nclass Share {\n\tconstructor(rootEl, config) {\n\t\tif (!rootEl) {\n\t\t\trootEl = document.body;\n\t\t} else if (!(rootEl instanceof HTMLElement)) {\n\t\t\trootEl = document.querySelector(rootEl);\n\t\t}\n\t\trootEl.setAttribute('data-o-share--js', '');\n\n\t\tthis.rootEl = rootEl;\n\t\tif (!config) {\n\t\t\tconfig = {};\n\t\t\tconfig.links = rootEl.hasAttribute('data-o-share-links') ? rootEl.getAttribute('data-o-share-links').split(' ') : defaultConfig.links;\n\t\t\tconfig.url = rootEl.getAttribute('data-o-share-url') || defaultConfig.url;\n\t\t\tconfig.title = rootEl.getAttribute('data-o-share-title') || defaultConfig.title;\n\t\t\tconfig.summary = rootEl.getAttribute('data-o-share-summary') || defaultConfig.summary;\n\t\t}\n\t\tthis.config = config;\n\t\tthis.openWindows = {};\n\n\t\tif (rootEl.children.length === 0) {\n\t\t\tthis.render();\n\t\t\tthis.addClickEvent();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst ulElement = document.createElement('ul');\n\n\t\tfor (let i = 0, len = this.config.links.length; i < len; i++) {\n\t\t\tconst link = this.config.links[i];\n\t\t\tconst linkName = socialUrls[link].name;\n\t\t\t\n\t\t\tconst liElement = document.createElement('li');\n\n\t\t\tliElement.className = 'o-share__action o-share__' + link;\n\t\t\t\n\t\t\tconst aElement = document.createElement('a');\n\n\t\t\taElement.href = this.generateSocialUrl(link);\n\t\t\taElement.setAttribute('title', '分享到'+linkName);\n\t\t\t\n\t\t\tconst iElement = document.createElement('i');\n\t\t\tiElement.innerHTML = linkName;\n\t\t\taElement.appendChild(iElement);\n\n\t\t\tliElement.appendChild(aElement);\n\t\t\tulElement.appendChild(liElement);\n\t\t}\n\t\tthis.rootEl.appendChild(ulElement);\n\t}\n\n\taddClickEvent() {\n\t\tthis.rootEl.addEventListener('click', (e) => {\n\t\t\tvar target = e.target;\n\t\t\te.preventDefault();\n\t\t\twhile (target.nodeName.toLowerCase() !== 'a') {\n\t\t\t\ttarget = target.parentNode\n\t\t\t}\n\t\t\tthis.shareSocial(target.href);\n\t\t});\n\t}\n\n\tshareSocial(url) {\n\t\tif (url) {\n\t\t\tif (this.openWindows[url] && !this.openWindows[url].closed) {\n\t\t\t\tthis.openWindows[url].focus();\n\t\t\t} else {\n\t\t\t\tthis.openWindows[url] = window.open(url, '', 'width=646,height=436');\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateSocialUrl (socialNetwork) {\n\t\tlet templateUrl = socialUrls[socialNetwork].url;\n\t\ttemplateUrl = templateUrl.replace('{{url}}', encodeURIComponent(this.config.url))\n\t\t\t.replace('{{title}}', encodeURIComponent(this.config.title))\n\t\t\t.replace('{{summary}}', encodeURIComponent(this.config.summary));\n\n\t\treturn templateUrl;\n\t}\n\n\tstatic init(el) {\n\t\tconst shareInstances = [];\n\n\t\tif (!el) {\n\t\t\tel =document.body;\n\t\t} else if (!el instanceof HTMLElement) {\n\t\t\tel = document.querySelector(el);\n\t\t}\n\n\t\tconst shareElements = el.querySelectorAll('[data-o-component=o-share]');\n\n\t\tfor (let i = 0; i < shareElements.length; i++) {\n\t\t\tshareInstances.push(new Share(shareElements[i]));\n\n\t\t}\n\n\t\treturn shareInstances;\n\t}\n}\n\nexport default Share;"],"names":["const","let","this"],"mappings":"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"}